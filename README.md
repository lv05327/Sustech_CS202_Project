# Sustech_CS202_Project
本项目是南方科技大学计算机系必修课程CS202，计算机组成原理的期末课程项目。本次得分为98/90，获得8分bonus。
# 🚀 单周期 RISC-V CPU 设计项目

本项目为一个基于 **RISC-V 指令集架构（ISA）** 的 **单周期 CPU 实现**，使用 Verilog HDL 编写，支持基础指令运行、外设控制、中断处理及浮点运算模拟，已成功部署在 FPGA 板卡（如 EGO1 开发板）上。

---

## 🧠 项目特色

- ✅ **RISC-V ISA 支持**：实现了常见整数指令，支持部分扩展（如乘法、auipc、ecall、ebreak）。
- ⚙️ **单周期架构**：CPI = 1，23 MHz 工作频率，哈佛结构，指令与数据空间各 64KB。
- 📦 **模块化设计**：包括 `IFetch`、`Decoder`、`Controller`、`ALU`、`DataMem`、`MemOrIO` 等模块，结构清晰。
- 🔌 **MMIO 外设支持**：
  - Switch 输入：`0xFFFFF800` / `0xFFFFF810`
  - LED 输出：`0xFFFFF820`
  - 数码管输出（HEX/DEC）：`0xFFFFF830` / `0xFFFFF840`
- 🧮 **软浮点支持**：采用软件方式模拟浮点数运算，避免硬件路径延迟带来的时钟频率降低。
- 🔁 **中断机制**：支持 `ecall`、`ebreak` 中断指令处理与继续执行逻辑。
- 📡 **UART 通信**：支持 UART 加载程序与通信（基于 IP 核），支持 10MHz 时钟。
- 🧪 **仿真测试**：完整的模块单元测试与集成测试，配套 testbench。
- 🧰 **自定义乘法器**：实现 `s_mul` 模块以支持符号整数乘法（移位+加法）。

---

## 👨‍💻 开发人员与分工

| 姓名 | 学号 | 主要负责模块 |
|------|------|----------------|
| 王锦翔 | 12311515 | 输入模块、内存管理、顶层连接、测试与汇编代码 |
| 李启豪 | 12313522 | 输出模块、Decoder、UART 通信、中期报告、调试工具 |
| 吕梓翀 | 12313605 | IFetch、Controller、ALU、扩展指令、中断机制 |

---

## 📐 系统参数与接口说明

- 时钟频率：23MHz（单周期）
- 指令空间：64KB；数据空间：64KB
- 地址位宽：32位，寻址单位：Byte
- 外设接口映射（MMIO）：
  - `0xFFFFF800`：数据输入（Switch 高 8 位）
  - `0xFFFFF810`：测试输入（Switch 低 3 位）
  - `0xFFFFF820`：LED 输出
  - `0xFFFFF830`：七段数码管（十六进制）
  - `0xFFFFF840`：七段数码管（十进制）

---
## 📁 项目结构

| 文件/模块 | 功能说明 |
|-----------|----------|
| `Top.v` | 顶层模块，连接 CPU 与外设 |
| `IFetch.v` | 指令获取模块，负责 PC 管理与 ROM 读取 |
| `Decoder.v` | 指令解码模块，提取 rs1, rs2, rd 和立即数 |
| `Controller.v` | 控制器模块，根据 opcode/funct 生成控制信号 |
| `ALU.v` | 运算逻辑单元，支持加减、逻辑运算、比较等 |
| `DataMem.v` | 数据存储器模块，读写内存 |
| `MemOrIO.v` | 统一管理内存与 IO 地址映射、数据通路控制 |
| `ioread.v` | IO 输入读取模块（如 Switch） |
| `leds.v` | LED 控制模块 |
| `light_7seg_controller.v` | 七段数码管控制器 |
| `scan_seg.v` | 数码管扫描逻辑 |
| `seg7_tb.v` | 七段数码管仿真测试 |
| `segs.v` | 七段数码管译码逻辑 |
| `the_trigger.v` | 用于输入同步的触发器模块 |
| `data_parser.v` | 外部数据预处理模块（如 UART 输入） |
| `decoder_test.v` | Decoder 模块的仿真测试文件 |

---

## 🧩 IP Core 模块说明（Vivado 集成）

| IP 核名           | 功能描述 |
|------------------|----------|
| `prgrom`         | 指令存储器 ROM，连接 `IFetch`，用于加载程序 |
| `RAM`            | 数据内存，连接 `DataMem` 与 `MemOrIO`，支持读写 |
| `uart_ips`       | 串口通信模块，支持 UART 程序加载 |
| `clk_wiz_0`      | 时钟管理模块，生成 UART 所需 10MHz 时钟 |
| `blk_mem_gen_0`  | Block RAM 生成器，用于 RAM / ROM 实现 |

---

## 🔧 使用说明（部署）

1. 使用 Vivado 打开工程，综合并生成比特流文件。
2. 按照文档连接 FPGA 板，配置各接口（Switch、LED、七段数码管）。
3. 使用 UART 上传程序并观察输出。
4. 重置：按 P15 复位，进入通信模式：按 R17，继续运行：按 U4。

---

## 💡 设计亮点（Bonus）

- ✔️ 软件乘法器 `s_mul`：在 ALU 内使用 Verilog 实现符号乘法仿真。
- ✔️ ecall/ebreak：通过中断方式控制程序中断与继续执行。
- ✔️ auipc：支持地址偏移计算，用于 PC 相对寻址。
- ✔️ UART 控制逻辑：支持通信模式进入与退出判定、信号去抖处理。

---

## 📌 License

本项目为课程项目用途，非商用开源。如需参考或转载，请注明原作者信息。

